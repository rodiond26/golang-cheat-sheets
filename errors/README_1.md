### Работа с ошибками и паниками

---

#### Ошибки

* В процессе разработки исключительные ситуации делятся на 2 части:
    * Ошибки, которые находятся под управлением разработчика.
    * Паники, которые выбрасываются системой в серьезных ситуациях, и система должно остановить свою работу.
* Ошибка в Golang - это интерфейс:

```go
type error interface {
    Error() string
} 
```

* Создание ошибок:

```go
err := errors.New("new error")
err := fmt.Errorf("new error: %v ", v)
err := fmt.Errorf("wrapped error: %w ", firstErr)
```

* Цепочка ошибок:

```go
// распаковка вложенной ошибки
prevErr := errors.Unwrap(currentErr)

// проверка конкретного значения ошибки
// проверка класса ошибки среди всех вложенных ошибок
if !errors.Is(err, target) {
...
}

if !errors.As(err, new(*ImportMissingError)) {...}
```

* Создание своей ошибки:

```go
type MyStruct struct {
    err error
}

func (ms *MyStruct) Error() string {
    return ms.err.Error()
}
```

#### Паники

* Паника в языке Golang - это встроенная функция, которая создает ошибку рантайма.
* Паника используется, когда произошло что-то критичное и серьезное, и после паники приложение крашится.
* Паника != исключение! Не нужно использовать панику как исключение.
* Во возможности не использовать паники, а использовать исключения.
* Вызов паники:

```go
panic("new panic")
```

* Восстановление после паники:

```go
recErr := recover()
```

#### Ошибки и паники

* Ошибки - это значения, т. е. любой тип данных, который реализует интерфейс error.
* Можно создавать вложенные ошибки.
* Паники - это не исключения.
* Восстановление из паники в горутинах необходимо делать в своем стеке вызовов.
* По возможности вместо паники выбрасывать ошибку.
